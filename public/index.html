<!-- Add this inside <body> -->
<div id="message" style="color: green; font-weight: bold; display: none;"></div>

<script>
  const form = document.getElementById('mcq-form');
  const preview = document.getElementById('preview');
  const message = document.getElementById('message');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    const formData = new FormData(form);
    const data = {
      question: formData.get('question'),
      options: [
        formData.get('option0'),
        formData.get('option1'),
        formData.get('option2'),
        formData.get('option3'),
      ],
      correctOption: parseInt(formData.get('correctOption')),
      subject: formData.get('subject'),
      topic: formData.get('topic'),
      difficulty: formData.get('difficulty')
    };

    const res = await fetch('/submit', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    });

    if (res.ok) {
      form.reset();
      preview.innerHTML = '';
      MathJax.typeset();
      message.textContent = '✅ Question added successfully!';
      message.style.display = 'block';

      setTimeout(() => {
        message.style.display = 'none';
      }, 3000);
    } else {
      alert('❌ Failed to submit question.');
    }
  });

  form.addEventListener('input', () => {
    const formData = new FormData(form);
    const question = formData.get('question');
    const options = [0, 1, 2, 3].map(i => formData.get(`option${i}`));
    const previewHTML = `
      <p><strong>Q:</strong> \\(${question}\\)</p>
      <ul>
        ${options.map((opt, i) => `<li>(${i}) \\(${opt}\\)</li>`).join('')}
      </ul>
    `;
    preview.innerHTML = previewHTML;
    MathJax.typeset();
  });
</script>
